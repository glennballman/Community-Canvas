ğŸ”§ REPLIT PATCH PROMPT â€” Platform Admin: User & Tenant Creation Wiring
CONTEXT

Platform Admin UI exists but is non-functional for user and tenant setup.

Problems:

â€œInvite Userâ€ button does nothing

No way to create tenants

No way to assign users as tenant admins

Tenant rows are not clickable

No impersonation or portal access from tenant list

This blocks QA for contractor workflows.

TASK 1 â€” Wire Invite User Button (Create User)
UI

When clicking Invite User on /app/platform/users:

Open a modal: CreateUserModal

Fields:

email (required)

fullName (optional)

password (optional; if set â†’ immediate login possible)

isPlatformAdmin (boolean)

Buttons:

Create User

Cancel

API

Add:

POST /api/platform/users


Body:

{
  "email": "ellen@enviropaving.com",
  "fullName": "Ellen",
  "password": "TempPass123!",
  "isPlatformAdmin": false
}


Behavior:

Create user

Hash password if provided

Return user record

Do NOT auto-email (dev safe)

TASK 2 â€” Add â€œCreate Tenantâ€ Button (Platform Admin)
UI

On /app/platform/tenants, add Create Tenant button (top right).

Modal: CreateTenantModal

Fields:

tenantName

slug

tenantType (business | government | individual)

API

Add:

POST /api/platform/tenants


Returns tenantId.

TASK 3 â€” Assign User as Tenant Admin

After creating tenant OR from tenant detail page:

API
POST /api/platform/tenants/:tenantId/users


Body:

{
  "userId": "uuid",
  "role": "admin"
}


Creates membership.

TASK 4 â€” Tenant Row Actions (CRITICAL)

On /app/platform/tenants each row must show icons on the right:

Icon	Action
ğŸ‘ View	Go to tenant portals
ğŸ”‘ Impersonate	Switch context to tenant
â• Add Admin	Open user picker
Behavior

Impersonate sets cc_impersonation_tenant_id

Redirects to /app/dashboard

Banner shows â€œImpersonating Tenantâ€

TASK 5 â€” Make Rows Clickable

Clicking a tenant row:

Navigates to /app/platform/tenants/:id

ACCEPTANCE CRITERIA (ALL REQUIRED)

Invite User opens modal and creates user

Create Tenant works

User can be assigned as tenant admin

Tenant rows have action icons

Impersonation works

No /admin/* routes used

No auth refactors

Proceed incrementally. Do not redesign.

Canonical Test Personas (Use These Exactly)

These give Replit stable anchors for all future QA.

ğŸ‘©â€ğŸ”§ Contractor Admin (Primary QA Actor)

User

Email: ellen@enviropaving.com

Name: Ellen

Password: DevPass123!

Tenants

1252093 BC Ltd (slug: enviropaving)

Remote Services Inc (slug: remote-services)

Role

Admin on both tenants

Contractor profile attached

ğŸ‘‰ Replit must use this user for contractor photo upload tests

ğŸ‘¨â€ğŸ’¼ Platform Admin (You)

glenn@envirogroupe.com

Platform Admin

Can create users/tenants

Can impersonate

ğŸ¤– Automation Bot (Optional)

qa-bot@example.com

No tenant access

Used only for API tests

Why This Is the Right Fix

âœ… Unblocks A2.7 contractor testing

âœ… Enables clean test data

âœ… Avoids legacy admin paths

âœ… Matches V3.5 mental model

âœ… Minimal surface area

âœ… Production-safe

Once this is in place:

Contractor photo upload testing will stop confusing Replit

Personas will stay stable

Youâ€™ll regain full control